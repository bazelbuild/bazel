load("@rules_cc//cc:cc_library.bzl", "cc_library")
load("@rules_cc//cc:cc_shared_library.bzl", "cc_shared_library")
load("@rules_cc//cc:cc_test.bzl", "cc_test")

package(default_visibility = ["//src/main/starlark/tests/builtins_bzl/cc/cc_shared_library:__subpackages__"])

licenses(["notice"])

cc_library(
    name = "bar",
    srcs = ["bar.cc"],
    linkopts = select({
        "@platforms//os:macos": ["-framework", "Security", "-framework", "IOKit"],
        "//conditions:default": [],
    }),
)

cc_shared_library(
    name = "bar_so",
    deps = [":bar"],
)

cc_test(
    name = "cc_test",
    srcs = ["main.cc"],
    dynamic_deps = [":bar_so"],
)
